esphome:
  friendly_name: 'hifi-fan'
  name: esphome-web-148771

esp8266:
  board: d1_mini

# Enable logging
logger:

switch:
  - platform: gpio
    pin: D8
    name: 'HiFi Fan'
    id: livingroom_hifi_fan
    restore_mode: ALWAYS_OFF

# Expose IR commands as buttons for the Universal Media Player integration.
button:

  # Cambridge AXR85 Receiver
  - platform: template
    id: axr85_toggle
    name: "Cambridge AXR85 Toggle"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_volup
    name: "Cambridge AXR85 Volume +"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_voldown
    name: "Cambridge AXR85 Volume -"
    on_press:
      remote_transmitter.transmit_pronto:
        data: 0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_mute
    name: "Cambridge AXR85 Mute"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_a1
    name: "Cambridge AXR85 Input A1"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_phono
    name: "Cambridge AXR85 Input Phono"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_tuner
    name: "Cambridge AXR85 Input Tuner"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0015 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ec 0155 0055 0015 0e46"
  - platform: template
    id: axr85_bluetooth
    name: "Cambridge AXR85 Input Bluetooth"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0000 006d 0024 0000 0155 00a9 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0015 0015 0040 0015 0040 0015 0040 0015 0015 0015 0040 0015 0015 0015 0040 0015 0040 0015 0015 0015 0015 0015 0015 0015 0040 0015 0015 0015 0040 0015 05ec 0155 0055 0015 0e46"

  # Topping E30 DAC
  - platform: template
    id: topping_toggle
    name: "Topping E30 Toggle"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0018 003F 0017 0014 0017 0014 0018 0014 0017 003F 0017 003F 0018 003F 0017 0014 0018 0014 0018 003F 0017 003F 0017 003F 0018 0181 06C3"
  - platform: template
    id: topping_left
    name: "Topping E30 Left"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0018 0014 0018 0014 0017 003F 0018 0014 0018 0014 0017 0014 0017 0014 0017 003F 0018 003F 0017 003F 0017 0014 0018 003F 0018 0181 06C3"
  - platform: template
    id: topping_right
    name: "Topping E30 Right"
    on_press:
      remote_transmitter.transmit_pronto:
        data: "0018 003F 0018 0014 0017 0014 0017 0014 0018 0014 0018 003F 0017 0014 0017 003F 0018 0014 0018 003F 0017 003F 0017 003F 0018 0181 06C3"

# Dallas sensors
dallas:
  - pin: D4

sensor:
  - platform: dallas
    address: 0x583cf5e38175f728
    name: 'Amplifier Temperature'
    id: livingroom_hifi_fan_temperature
    on_value_range:
      - above: 30.0
        then:
          - switch.turn_on: livingroom_hifi_fan
      - below: 26.0
        then:
          - switch.turn_off: livingroom_hifi_fan

remote_receiver:
  pin:
    number: D5
    inverted: true
  dump: all

remote_transmitter:
  pin: D7
  carrier_duty_percent: 50%

# Enable Home Assistant API
api:
  encryption:
    key: !secret hififan_key

ota:

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: 'Esphome-Web-148771'
    password: !secret wifi_fallback

captive_portal: